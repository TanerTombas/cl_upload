!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,s){var o,n,a,r=e.nodeName.toLowerCase();return"area"===r?(n=(o=e.parentNode).name,!(!e.href||!n||"map"!==o.nodeName.toLowerCase())&&(a=t("img[usemap='#"+n+"']")[0],!!a&&i(a))):(/^(input|select|textarea|button|object)$/.test(r)?!e.disabled:"a"===r?e.href||s:s)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),s="absolute"===i,o=e?/(auto|scroll|hidden)/:/(auto|scroll)/,n=this.parents().filter(function(){var e=t(this);return(!s||"static"!==e.css("position"))&&o.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&n.length?n:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var s=t.attr(i,"tabindex"),o=isNaN(s);return(o||s>=0)&&e(i,!o)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,i){function s(e,i,s,n){return t.each(o,function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),n&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var o="Width"===i?["Left","Right"]:["Top","Bottom"],n=i.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?a["inner"+i].call(this):this.each(function(){t(this).css(n,s(this,e)+"px")})},t.fn["outer"+i]=function(e,o){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){t(this).css(n,s(this,e,!0,o)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=(o=t.fn.removeData,function(e){return arguments.length?o.call(this,t.camelCase(e)):o.call(this)})),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:(s=t.fn.focus,function(e,i){return"number"==typeof e?this.each(function(){var s=this;setTimeout(function(){t(s).focus(),i&&i.call(s)},e)}):s.apply(this,arguments)}),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,s,o=t(this[0]);o.length&&o[0]!==document;){if(("absolute"===(i=o.css("position"))||"relative"===i||"fixed"===i)&&(s=parseInt(o.css("zIndex"),10),!isNaN(s)&&0!==s))return s;o=o.parent()}return 0}}),t.ui.plugin={add:function(e,i,s){var o,n=t.ui[e].prototype;for(o in s)n.plugins[o]=n.plugins[o]||[],n.plugins[o].push([i,s[o]])},call:function(t,e,i,s){var o,n=t.plugins[e];if(n&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(o=0;n.length>o;o++)t.options[n[o][0]]&&n[o][1].apply(t.element,i)}};var s,o,n=0,a=Array.prototype.slice;t.cleanData=(r=t.cleanData,function(e){var i,s,o;for(o=0;null!=(s=e[o]);o++)try{(i=t._data(s,"events"))&&i.remove&&t(s).triggerHandler("remove")}catch(t){}r(e)}),t.widget=function(e,i,s){var o,n,a,r,l={},h=e.split(".")[0];return e=e.split(".")[1],o=h+"-"+e,s||(s=i,i=t.Widget),t.expr[":"][o.toLowerCase()]=function(e){return!!t.data(e,o)},t[h]=t[h]||{},n=t[h][e],a=t[h][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,n,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),(r=new i).options=t.widget.extend({},r.options),t.each(s,function(e,s){return t.isFunction(s)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},o=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,n=this._superApply;return this._super=t,this._superApply=o,e=s.apply(this,arguments),this._super=i,this._superApply=n,e}}()):void(l[e]=s)}),a.prototype=t.widget.extend(r,{widgetEventPrefix:n?r.widgetEventPrefix||e:e},l,{constructor:a,namespace:h,widgetName:e,widgetFullName:o}),n?(t.each(n._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,a,i._proto)}),delete n._childConstructors):i._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(e){for(var i,s,o=a.call(arguments,1),n=0,r=o.length;r>n;n++)for(i in o[n])s=o[n][i],o[n].hasOwnProperty(i)&&void 0!==s&&(e[i]=t.isPlainObject(s)?t.isPlainObject(e[i])?t.widget.extend({},e[i],s):t.widget.extend({},s):s);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(o){var n="string"==typeof o,r=a.call(arguments,1),l=this;return n?this.each(function(){var i,n=t.data(this,s);return"instance"===o?(l=n,!1):n?t.isFunction(n[o])&&"_"!==o.charAt(0)?(i=n[o].apply(n,r))!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")}):(r.length&&(o=t.widget.extend.apply(null,[o].concat(r))),this.each(function(){var e=t.data(this,s);e?(e.option(o||{}),e._init&&e._init()):t.data(this,s,new i(o,this))})),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,o,n,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},s=e.split("."),e=s.shift(),s.length){for(o=a[e]=t.widget.extend({},this.options[e]),n=0;s.length-1>n;n++)o[s[n]]=o[s[n]]||{},o=o[s[n]];if(e=s.pop(),1===arguments.length)return void 0===o[e]?null:o[e];o[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,s){var o,n=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=o=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,o=this.widget()),t.each(s,function(s,a){function r(){return e||!0!==n.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?n[a]:a).apply(n,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+n.eventNamespace,c=l[2];c?o.delegate(c,h,r):i.bind(h,r)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var i=this;return setTimeout(function(){return("string"==typeof t?i[t]:t).apply(i,arguments)},e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,s){var o,n,a=this.options[e];if(s=s||{},(i=t.Event(i)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],n=i.originalEvent)for(o in n)o in i||(i[o]=n[o]);return this.element.trigger(i,s),!(t.isFunction(a)&&!1===a.apply(this.element[0],[i].concat(s))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,o,n){"string"==typeof o&&(o={effect:o});var a,r=o?!0===o||"number"==typeof o?i:o.effect||i:e;"number"==typeof(o=o||{})&&(o={duration:o}),a=!t.isEmptyObject(o),o.complete=n,o.delay&&s.delay(o.delay),a&&t.effects&&t.effects.effect[r]?s[e](o):r!==e&&s[r]?s[r](o.duration,o.easing,n):s.queue(function(i){t(this)[e](),n&&n.call(s[0]),i()})}}),t.widget;var r,l=!1;t(document).mouseup(function(){l=!1}),t.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!l){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,s=1===e.which,o=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(s&&!o&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),l=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),l=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.widget("ui.draggable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),!(this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===i.iframeFix?"iframe":i.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(t){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(!1===this._trigger("drag",e,s))return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,s=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(s=t.ui.ddmanager.drop(this,e)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||!0===this.options.revert||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==i._trigger("stop",e)&&i._clear()}):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!t(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper),o=s?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return o.parents("body").length||o.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&o[0]===this.element[0]&&this._setPositionRelative(),o[0]===this.element[0]||/(fixed|absolute)/.test(o.css("position"))||o.css("position","absolute"),o},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,o=this.options,n=this.document[0];return this.relativeContainer=null,o.containment?"window"===o.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||n.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,t(n).width()-this.helperProportions.width-this.margins.left,(t(n).height()||n.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),void((s=(i=t(o.containment))[0])&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,o,n,a=this.options,r=this._isRootNode(this.scrollParent[0]),l=t.pageX,h=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),a.grid&&(o=a.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,h=i?o-this.offset.click.top>=i[1]||o-this.offset.click.top>i[3]?o:o-this.offset.click.top>=i[1]?o-a.grid[1]:o+a.grid[1]:o,n=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?n-this.offset.click.left>=i[0]||n-this.offset.click.left>i[2]?n:n-this.offset.click.left>=i[0]?n-a.grid[0]:n+a.grid[0]:n),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,s){var o=t.extend({},i,{item:s.element});s.sortables=[],t(s.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,o))})},stop:function(e,i,s){var o=t.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,t.each(s.sortables,function(){this.isOver?(this.isOver=0,s.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(e),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",e,o))})},drag:function(e,i,s){t.each(s.sortables,function(){var o=!1,n=this;n.positionAbs=s.positionAbs,n.helperProportions=s.helperProportions,n.offset.click=s.offset.click,n._intersectsWith(n.containerCache)&&(o=!0,t.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==n&&this._intersectsWith(this.containerCache)&&t.contains(n.element[0],this.element[0])&&(o=!1),o})),o?(n.isOver||(n.isOver=1,s._parent=i.helper.parent(),n.currentItem=i.helper.appendTo(n.element).data("ui-sortable-item",!0),n.options._helper=n.options.helper,n.options.helper=function(){return i.helper[0]},e.target=n.currentItem[0],n._mouseCapture(e,!0),n._mouseStart(e,!0,!0),n.offset.click.top=s.offset.click.top,n.offset.click.left=s.offset.click.left,n.offset.parent.left-=s.offset.parent.left-n.offset.parent.left,n.offset.parent.top-=s.offset.parent.top-n.offset.parent.top,s._trigger("toSortable",e),s.dropped=n.element,t.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,n.fromOutside=s),n.currentItem&&(n._mouseDrag(e),i.position=n.position)):n.isOver&&(n.isOver=0,n.cancelHelperRemoval=!0,n.options._revert=n.options.revert,n.options.revert=!1,n._trigger("out",e,n._uiHash(n)),n._mouseStop(e,!0),n.options.revert=n.options._revert,n.options.helper=n.options._helper,n.placeholder&&n.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(e),i.position=s._generatePosition(e,!0),s._trigger("fromSortable",e),s.dropped=!1,t.each(s.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,s){var o=t("body"),n=s.options;o.css("cursor")&&(n._cursor=o.css("cursor")),o.css("cursor",n.cursor)},stop:function(e,i,s){var o=s.options;o._cursor&&t("body").css("cursor",o._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,s){var o=t(i.helper),n=s.options;o.css("opacity")&&(n._opacity=o.css("opacity")),o.css("opacity",n.opacity)},stop:function(e,i,s){var o=s.options;o._opacity&&t(i.helper).css("opacity",o._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,s){var o=s.options,n=!1,a=s.scrollParentNotHidden[0],r=s.document[0];a!==r&&"HTML"!==a.tagName?(o.axis&&"x"===o.axis||(s.overflowOffset.top+a.offsetHeight-e.pageY<o.scrollSensitivity?a.scrollTop=n=a.scrollTop+o.scrollSpeed:e.pageY-s.overflowOffset.top<o.scrollSensitivity&&(a.scrollTop=n=a.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(s.overflowOffset.left+a.offsetWidth-e.pageX<o.scrollSensitivity?a.scrollLeft=n=a.scrollLeft+o.scrollSpeed:e.pageX-s.overflowOffset.left<o.scrollSensitivity&&(a.scrollLeft=n=a.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(e.pageY-t(r).scrollTop()<o.scrollSensitivity?n=t(r).scrollTop(t(r).scrollTop()-o.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<o.scrollSensitivity&&(n=t(r).scrollTop(t(r).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(e.pageX-t(r).scrollLeft()<o.scrollSensitivity?n=t(r).scrollLeft(t(r).scrollLeft()-o.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<o.scrollSensitivity&&(n=t(r).scrollLeft(t(r).scrollLeft()+o.scrollSpeed)))),!1!==n&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(s,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,s){var o=s.options;s.snapElements=[],t(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var e=t(this),i=e.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,s){var o,n,a,r,l,h,c,p,d,u,f=s.options,g=f.snapTolerance,m=i.offset.left,v=m+s.helperProportions.width,_=i.offset.top,b=_+s.helperProportions.height;for(d=s.snapElements.length-1;d>=0;d--)l=s.snapElements[d].left-s.margins.left,h=l+s.snapElements[d].width,c=s.snapElements[d].top-s.margins.top,p=c+s.snapElements[d].height,l-g>v||m>h+g||c-g>b||_>p+g||!t.contains(s.snapElements[d].item.ownerDocument,s.snapElements[d].item)?(s.snapElements[d].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(o=g>=Math.abs(c-b),n=g>=Math.abs(p-_),a=g>=Math.abs(l-v),r=g>=Math.abs(h-m),o&&(i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top),n&&(i.position.top=s._convertPositionTo("relative",{top:p,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left)),u=o||n||a||r,"outer"!==f.snapMode&&(o=g>=Math.abs(c-_),n=g>=Math.abs(p-b),a=g>=Math.abs(l-m),r=g>=Math.abs(h-v),o&&(i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top),n&&(i.position.top=s._convertPositionTo("relative",{top:p-s.helperProportions.height,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left)),!s.snapElements[d].snapping&&(o||n||a||r||u)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=o||n||a||r||u)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,s){var o,n=s.options,a=t.makeArray(t(n.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});a.length&&(o=parseInt(t(a[0]).css("zIndex"),10)||0,t(a).each(function(e){t(this).css("zIndex",o+e)}),this.css("zIndex",o+a.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,s){var o=t(i.helper),n=s.options;o.css("zIndex")&&(n._zIndex=o.css("zIndex")),o.css("zIndex",n.zIndex)},stop:function(e,i,s){var o=s.options;o._zIndex&&t(i.helper).css("zIndex",o._zIndex)}}),t.ui.draggable}),function(t){function e(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var i=t.originalEvent.changedTouches[0],s=document.createEvent("MouseEvents");s.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(s)}}if(t.support.touch="ontouchend"in document,t.support.touch){var i,s=t.ui.mouse.prototype,o=s._mouseInit,n=s._mouseDestroy;s._touchStart=function(t){!i&&this._mouseCapture(t.originalEvent.changedTouches[0])&&(i=!0,this._touchMoved=!1,e(t,"mouseover"),e(t,"mousemove"),e(t,"mousedown"))},s._touchMove=function(t){i&&(this._touchMoved=!0,e(t,"mousemove"))},s._touchEnd=function(t){i&&(e(t,"mouseup"),e(t,"mouseout"),this._touchMoved||e(t,"click"),i=!1)},s._mouseInit=function(){this.element.bind({touchstart:t.proxy(this,"_touchStart"),touchmove:t.proxy(this,"_touchMove"),touchend:t.proxy(this,"_touchEnd")}),o.call(this)},s._mouseDestroy=function(){this.element.unbind({touchstart:t.proxy(this,"_touchStart"),touchmove:t.proxy(this,"_touchMove"),touchend:t.proxy(this,"_touchEnd")}),n.call(this)}}}(jQuery),bwrsUpload_lang_en={upload_info:"Uploaded Images (Drag Or Click Here)",image_proccesing:"Image Proccesing...",image_proccesing_loop:"Image Processing [%RANKED% / %TOTAL%]",upload_proccesing_loop:"Uploading Images [%RANKED% / %TOTAL%] [%PERCENT%%]",upload_error:"404 Error\nCancelled",serializing:"Serializing Please Wait...",dragging_info:"You can change the position of the image by dragging",max_file_limit:"Max Image Limit: %OPTMAXFILE%",only_support_types:"Only support: %TYPES% files"},bwrsUpload_lang_tr={upload_info:"Fotoğraf Yüklemek İçin Buraya Tıklayın veya Fotoğraf Buraya Bırakın",image_proccesing:"Görüntü İşleniyor...",image_proccesing_loop:"Görüntü İşleniyor... [%RANKED% / %TOTAL%]",upload_proccesing_loop:"Resimler Yükleniyor [%RANKED% / %TOTAL%] [%PERCENT%%]",upload_error:"404 Hatası\nİşlem İptal Edildi",serializing:"Veriler İşleniyor Lütfen Bekleyiniz...",dragging_info:"Yüklenmiş Resimlerinizi Hareket Ettirerek Nereden Kırpılacağını Belirleyebilirsiniz",max_file_limit:"En Fazla %OPTMAXFILE% Resim Yükleyebilirsiniz",only_support_types:"Sadece %TYPES% uzantılı dosyaları yükleyebilirsiniz"},$.fn.bwrsUpload=function(t){var e=this;e.options=$.extend({success:function(){},error:function(){},language:"tr",file:{max:9999,maxSize:9999999999},background:"#fff",form:e.parents("form:first")},arguments[0]||{}),this.initialize=function(){return e.text=window["bwrsUpload_lang_"+e.options.language],$(this).addClass("bwrsUpload").append('<input type="file" name="file[]" id="clfile" class="hidden" class="clfile" multiple/><a href="javascript:;" id="cl-info">'+e.text.upload_info+'<span class="cl-stats"></span></a><div class="cl-info-inside hidden"></div><canvas style="display:none; background:#fff" id="dcanvas"></canvas><figure style="display:none" id="gl_0"><div class="cl-top-wrapper"><div class="cl-top" style="width:'+Math.round(e.options.width/e.options.thumbRatio)+"px; height: "+Math.round(e.options.height/e.options.thumbRatio)+'px;"><img src=""></div></div><div class="cl-bottom"><div class="cl-file-name"></div><div class="cl-file-size"></div><div class="cl-remove"></div><div class="cl-fit"></div></div></figure>'),e.options.target=e.find("#clfile"),e.options.clinfo=e.find("#cl-info"),e.canvas=document.getElementById("dcanvas"),$(e.options.clinfo).click(function(t){t.preventDefault(),t.stopPropagation(),$(e.options.target).click()}),e[0].ondragover=function(){return $(this).addClass("hover"),!1},e[0].ondragleave=function(){return $(this).removeClass("hover"),!1},e[0].ondrop=function(t){$(this).removeClass("hover"),t.preventDefault(),t.dataTransfer.files.length>0&&s(t.dataTransfer.files)},$(e.options.target).change(function(t){$(this).get(0).files.length>0&&s($(this).get(0).files)}),$(e.options.form).submit(function(t){t.preventDefault(),t.stopPropagation();var i=e.find("figure").length-1;$(e.options.target).val(""),i<1?(e.options.success.call(this,$(e.options.form)),r()):(window.clTry=0,h(1))}),e.on("click",".cl-remove",function(){$(this).parent().parent().remove(),a()}),e.on("click",".cl-fit",function(){r(e.text.image_proccesing);var t=$(this).parent().parent();setTimeout(function(){e.fit(t)},50)}),e.on("dblclick","figure .cl-top",function(){r(e.text.image_proccesing);var t=$(this);setTimeout(function(){e.fit(t)},50)}),$(window).resize(function(t){a()}),this},this.fit=function(t){var s=t.find("img"),o=s.data("original");s.data("fit");if(o)return s.attr("src",o.src),$.each(o.css,function(t,e){s.css(t,e)}),s.data("original",""),r(),a(),!1;var n=new Image;n.src=s.attr("src");var l=n.naturalWidth,h=n.naturalHeight;if(l/h>=e.options.width/e.options.height){var c=e.options.width/l,p=e.options.height-h*c;i({data:n.src,quality:100,x1:0,y1:0,x2:l,y2:h,cx:0,cy:p/2,width:e.options.width,height:h*c,canvasWidth:e.options.width,canvasHeight:e.options.height},function(t){r(),s.data("original",{src:n.src,css:{width:s.css("width"),height:"100%",left:s.css("left"),top:s.css("top"),cursor:s.css("cursor")}}),s.attr("src",t).css({left:"0px",top:"0px",width:"100%",height:"100%",cursor:"default"}),a()})}else{c=e.options.height/h,p=e.options.width-l*c;i({data:n.src,quality:100,x1:0,y1:0,x2:l,y2:h,cx:p/2,cy:0,width:l*c,height:e.options.height,canvasWidth:e.options.width,canvasHeight:e.options.height},function(t){r(),s.data("original",{src:n.src,css:{height:s.css("height"),width:"100%",left:s.css("left"),top:s.css("top"),cursor:s.css("cursor")}}),s.attr("src",t).css({left:"0px",top:"0px",width:"100%",height:"100%",cursor:"default"}),a()})}};function i(t,i){img=new Image,img.setAttribute("crossOrigin","Anonymous"),img.src=t.data,img.onload=function(){var s=document.getElementById("dcanvas"),o=s.getContext("2d");o.clearRect(0,0,s.width,s.height),s.width=t.canvasWidth,s.height=t.canvasHeight,o.fillStyle=e.options.background,o.fillRect(0,0,s.width,s.height),o.drawImage(img,t.x1,t.y1,t.x2,t.y2,t.cx,t.cy,t.width,t.height);var n=s.toDataURL("image/jpeg",e.options.quality/100);i(n)}}return e.serialize=function(t){e.serializeArray=[],r(e.text.serializing),l(1,t)},e.stop=function(t){e.stopped=!0},e.reset=function(){r(),e.html(""),e.initialize()},e.initialize();function s(t){var i=!1;if($.each(t,function(t,s){var o=e.text.only_support_types.replace("%TYPES%","jpeg,png,gif,bmp");"image/jpeg"==s.type||"image/png"==s.type||"image/bmp"==s.type||"image/gif"==s.type?totalSize=e.totalSize+s.size:i=o}),i)return e.options.error.call(this,i),!1;var s=t.length;if(e.find("figure").length-1+s>e.options.file.max){var o=e.text.max_file_limit.replace("%OPTMAXFILE%",e.options.file.max);e.options.error.call(this,o)}else $(e.options.clinfo).text(e.text.dragging_info),n(0,function(t){r(),a()},t)}function o(t,e){var i=new FileReader;i.onload=function(t){var i=new DataView(t.target.result);if(65496!=i.getUint16(0,!1))return e(-2);for(var s=i.byteLength,o=2;o<s;){var n=i.getUint16(o,!1);if(o+=2,65505==n){1165519206!=i.getUint32(o+=2,!1)&&e(-1);var a=18761==i.getUint16(o+=6,!1);o+=i.getUint32(o+4,a);var r=i.getUint16(o,a);o+=2;for(var l=0;l<r;l++)if(274==i.getUint16(o+12*l,a))return e(i.getUint16(o+12*l+8,a))}else{if(65280!=(65280&n))break;o+=i.getUint16(o,!1)}}return e(-1)},i.readAsArrayBuffer(t.slice(0,65536))}function n(t,i,s){var l=s.length;r(e.text.image_proccesing_loop.replace("%RANKED%",Number(t+1)).replace("%TOTAL%",l));var h=s[t];o(h,function(l){if(l>4)!function(t,i,s,l){var h=s.length;r(e.text.image_proccesing_loop.replace("%RANKED%",Number(t+1)).replace("%TOTAL%",h));var p=s[t];o(p,function(o){var l=new FileReader;image_filename=p.name,image_filesize=p.size,l.onload=function(h){original_data=l.result,current_image=new Image,current_image.src=l.result,current_image.onload=function(){var l=e.canvas,h=l.getContext("2d"),p=current_image.naturalWidth,d=current_image.naturalHeight;switch(l.width=d,l.height=p,o){case 5:h.rotate(90*Math.PI/180),h.scale(1,-1);break;case 6:h.rotate(90*Math.PI/180),h.translate(0,-d);break;case 7:h.rotate(.5*Math.PI),h.translate(p,-d),h.scale(-1,1);break;case 8:h.rotate(-.5*Math.PI),h.translate(-p,0)}h.drawImage(current_image,0,0,p,d);var u=l.toDataURL("image/jpeg",e.options.quality/100);current_image=new Image,current_image.src=u,current_image.onload=function(){var o=e.canvas,l=o.getContext("2d");l.clearRect(0,0,o.width,o.height);var h=current_image.naturalWidth,p=current_image.naturalHeight;o.width=e.options.width,o.height=e.options.height,l.fillStyle=e.options.background,l.fillRect(0,0,C,g);var d=e.options.width/e.options.height,u=h/p,f=2*e.options.thumbRatio;if(u>=d){var g=p*(I=e.options.height/p),m=0,v=h,_=0,b=p,w="auto",y="100%",x=-1*((C=h*I)-e.options.width)/f+"px",P="0px";if(C-e.options.width)var E="e-resize";var T="x"}else{var I,C=h*(I=e.options.width/h);m=0,v=h,_=0,b=p,w="100%",y="auto",x="0px",P=-1*((g=p*I)-e.options.height)/f+"px",g-e.options.height&&(E="s-resize"),T="y"}o.width=C,o.height=g,l.fillStyle=e.options.background,l.fillRect(0,0,C,g),l.drawImage(current_image,m,_,v,b,0,0,C,g);var N=o.toDataURL("image/jpeg",e.options.quality/100);finimg=new Image,finimg.src=N,finimg.onload=function(){var o=e.find("#gl_0").clone().appendTo(e).removeClass("hidden").show().addClass("cl-added").find("img");o.parent().offset().left,o.parent().offset().top,o.attr("src",N).css({width:w,height:y,left:x,top:P,cursor:E}),o.parent().attr("data-axis",T),o.parent().attr("data-name",image_filename),o.parent().parent().parent().find(".cl-file-name").text(image_filename),o.parent().parent().parent().find(".cl-file-size").text(c(image_filesize)),t<s.length-1?(n(t+1,i,s),a()):(r(),i("OK"),a())}}}},l.readAsDataURL(p)})}(t,i,s);else{var p=new FileReader;image_filename=h.name,image_filesize=h.size,p.onload=function(o){original_data=p.result,current_image=new Image,current_image.src=p.result,current_image.onload=function(){var o=e.canvas,h=o.getContext("2d");h.clearRect(0,0,o.width,o.height);var p=current_image.naturalWidth,d=current_image.naturalHeight;o.width=e.options.width,o.height=e.options.height,h.fillStyle=e.options.background,h.fillRect(0,0,N,m);var u=e.options.width/e.options.height,f=p/d,g=2*e.options.thumbRatio;if(f>=u){var m=d*(C=e.options.height/d),v=0,_=p,b=0,w=d,y="auto",x="100%",P=-1*((N=p*C)-e.options.width)/g+"px",E="0px";if(N-e.options.width)var T="e-resize";var I="x"}else{var C,N=p*(C=e.options.width/p);v=0,_=p,b=0,w=d,y="100%",x="auto",P="0px",E=-1*((m=d*C)-e.options.height)/g+"px";if(m-e.options.height)T="s-resize";I="y"}switch(o.width=N,o.height=m,h.fillStyle=e.options.background,h.fillRect(0,0,N,m),l){case 2:h.translate(o.width,0),h.scale(-1,1);break;case 3:h.translate(o.width,o.height),h.rotate(Math.PI);break;case 4:h.translate(0,o.height),h.scale(1,-1)}h.drawImage(current_image,v,b,_,w,0,0,N,m);var k=o.toDataURL("image/jpeg",e.options.quality/100);finimg=new Image,finimg.src=k,finimg.onload=function(){var o=e.find("#gl_0").clone().appendTo(e).removeClass("hidden").show().addClass("cl-added").find("img");o.parent().offset().left,o.parent().offset().top;o.attr("src",k).css({width:y,height:x,left:P,top:E,cursor:T}),o.parent().attr("data-axis",I),o.parent().attr("data-name",image_filename),o.parent().parent().parent().find(".cl-file-name").text(image_filename),o.parent().parent().parent().find(".cl-file-size").text(c(image_filesize)),t<s.length-1?(n(t+1,i,s),a()):(r(),i("OK"),a())}}},p.readAsDataURL(h)}})}function a(){e.find(".cl-added").each(function(){var t=$(this).find(".cl-top").attr("data-axis"),e=$(this).find("img").width(),i=$(this).find("img").height(),s=$(this).find(".cl-top").width(),o=$(this).find(".cl-top").height(),n=$(this).find(".cl-top").offset().left,a=$(this).find(".cl-top").offset().top,r=Math.abs(e-s),l=Math.abs(i-o);s!=e||o!=i?($(this).find("img").draggable({axis:t,containment:[n-r,a-l,n,a]}),$(this).data("dragged",!0),$(this).find("img").draggable("enable")):$(this).data("dragged")?($(this).find("img").css("cursor","default"),$(this).find("img").draggable("disable")):($(this).find("img").css("cursor","default"),$(this).find(".cl-fit").remove())})}function r(t){var i=e.find(".cl-info-inside");t?($("html, body").scrollTop(i.offset().top-20),i.removeClass("hidden"),i.text(t)):i.text("").addClass("hidden")}function l(t,i){var s=e.find("figure").length-1,o=e.find("figure:eq("+t+")"),n=o.find("img"),a=o.find(".cl-top").attr("data-name");if(s<1)return i(!1),r(),!1;uImg=new Image,uImg.src=n.attr("src");var h=uImg.naturalWidth/n.width(),c=n.css("left").split("px")[0],p=(c=Math.abs(c*h),n.css("top").split("px")[0]);p=Math.abs(p*h);uImg.onload=function(){var n=document.getElementById("dcanvas"),h=n.getContext("2d");h.clearRect(0,0,n.width,n.height),n.width=e.options.width,n.height=e.options.height,h.drawImage(uImg,c,p,e.options.width,e.options.height,0,0,e.options.width,e.options.height);var d=n.toDataURL("image/jpeg",e.options.quality/100);o.find(".cl-top").attr("data-newsize",(u=d,Math.round(3*(u.length-"data:image/jpeg;base64,".length)/4)));var u;if(e.serializeArray.push({data:d,name:a}),!(t+1<=s))return r(),i(e.serializeArray),!1;l(t+1,i)}}function h(t){var i=e.find("figure").length-1,s=e.find("figure:eq("+t+")"),o=s.find("img"),n=s.find(".cl-top").attr("data-name"),a=o.attr("src");uImg=new Image,uImg.src=a;var l=uImg.naturalWidth/o.width(),c=o.css("left").split("px")[0],p=(c=Math.abs(c*l),o.css("top").split("px")[0]);p=Math.abs(p*l);uImg.onload=function(){var s=document.getElementById("dcanvas"),o=s.getContext("2d");o.clearRect(0,0,s.width,s.height),s.width=e.options.width,s.height=e.options.height,o.drawImage(uImg,c,p,e.options.width,e.options.height,0,0,e.options.width,e.options.height);var a=s.toDataURL("image/jpeg",e.options.quality/100);$.ajax({xhr:function(){var s=new window.XMLHttpRequest;return s.upload.addEventListener("progress",function(s){if(s.lengthComputable){var o=s.loaded/s.total;r(e.text.upload_proccesing_loop.replace("%RANKED%",t).replace("%TOTAL%",i).replace("%PERCENT%",Math.round(100*o)))}},!1),s},url:e.options.imageUpload.url,type:"POST",dataType:"html",data:{src:a,name:n,exdata:e.options.imageUpload.exData},success:function(s){console.log(s),t+1<=i?h(t+1):(e.options.success.call(this,$(e.options.form)),r())},error:function(){window.clTry>5?(e.find(".cl-added").remove(),r(),e.options.error.call(this,e.text.upload_error)):(h(t),window.clTry=window.clTry+1)}})}}function c(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=[],s=0,o=void 0,n=void 0,a=void 0,r=void 0,l=void 0,h=void 0,c=void 0,p=void 0,d=void 0,u=void 0,f=void 0;if(isNaN(t))throw new Error("Invalid arguments");return a=!0===e.bits,d=!0===e.unix,n=e.base||2,p=void 0!==e.round?e.round:d?1:2,u=void 0!==e.spacer?e.spacer:d?"":" ",f=e.symbols||e.suffixes||{},c=e.output||"string",o=void 0!==e.exponent?e.exponent:-1,l=(h=Number(t))<0,r=n>2?1e3:1024,l&&(h=-h),0===h?(i[0]=0,i[1]=d?"":a?"b":"B"):((-1===o||isNaN(o))&&(o=Math.floor(Math.log(h)/Math.log(r)))<0&&(o=0),o>8&&(o=8),s=2===n?h/Math.pow(2,10*o):h/Math.pow(1e3,o),a&&(s*=8)>r&&o<8&&(s/=r,o++),i[0]=Number(s.toFixed(o>0?p:0)),i[1]=10===n&&1===o?a?"kb":"kB":{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}[a?"bits":"bytes"][o],d&&(i[1]=i[1].charAt(0),/^(b|B)$/.test(i[1])&&(i[0]=Math.floor(i[0]),i[1]=""))),l&&(i[0]=-i[0]),i[1]=f[i[1]]||i[1],"array"===c?i:"exponent"===c?o:"object"===c?{value:i[0],suffix:i[1],symbol:i[1]}:i.join(u)}};
